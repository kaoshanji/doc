#   I/O


##  文件概述

介绍文件有关的一些基本概念和常识，Java中处理文件的基本思路和类结构。

1.  基本概念和常识
-   二进制思维

所有文件，不论是可执行文件、图片文件、视频文件、word文件、压缩文件、txt文件，都是以0和1的二进制形式保存的。所看到的图片、视频、文本，都是应用程序对这些二进制的解析结果

-   文件类型

所有文件都是以二进制形式保存，但为了便于理解和处理文件，文件有文件类型的概念。

文件类型通常以扩展名的形式体现，比如，PDF文件类型的扩展名是`.pdf`，图片文件的一种常见扩展名是`.jpg`，压缩文件的一种常见扩展名是`.zip`，每种文件类型都有一定的格式，代表着文件含义和二进制之间的映射关系

对于一种文件类型，往往有一种或多种应用程序可以解读他，进行查看和编辑，一个应用程序往往可以解读一种或多种文件类型

文件类型可以粗略分为两类：一类是文本文件；另一类是二进制文件。文本文件的例子有普通的文本文件(.txt)、程序源代码文件(.java)、HTML文件(.html)等，二进制文件的例子有压缩文件、PDF文件、MP3文件、Excel文件。

文本文件里的每个二进制字节都是某个可打印字符的一部分，都可以用文本编辑器查看和编辑。二进制文件中，每个字节就不一定表示字符，可能是颜色、字体、声音等，用文本编辑器打开就乱码，需要专门的应用程序打开。

-   文本文件的编码

对于文本文件，需要注意编码方式。文本文件中包含的基本都是可打印字符，但字符到二进制的映射(即编码)却有多种方式，如GB18030、UTF-8。

-   文件系统

文件一般是放在硬盘上的，一个机器上可能有多个硬盘，但各种操作系统都会隐藏物理硬盘概念，提供一个逻辑上的统一结构

每个文件除了具体内容，还有元数据信息，如文件名、创建时间、修改时间等。

-   文件读写

文件是放在硬盘上，程序处理文件需要将文件读入内存，修改后，需要写回硬盘。

硬盘访问延时与内存相比，是很慢的。一般而言，尽量减少接触硬盘、接触一次，就一次多做一些事情

一般读写文件需要两次数据复制，比如读文件，需要先从硬盘复制到操作系统内核，再从内核复制到应用程序分配的内核中。操作系统运行所在的环境和应用程序是不一样的，操作系统所在的环境是内核态，应用程序是用户态，应用程序调用操作系统地功能，需要两次环境的切换，先用用户态切到内核态，再从内核态切到用户态，这种用户态/内核态的切换时有开销的，应尽量减少这种切换。

2.  Java文件概述

在Java中处理文件有一些基本概念和类，包括流、装饰器设计模式、Reader/Writer、随机读写文件、File、NIO、序列化和反序列化

-   流

流有输入流和输出流之分，输入流就是可以从中获取数据，输出流可以向其中写入数据

Java IO的基本类大多位于文件输入流。类InputStream表述输入流，OutputStream表述输出流，而FileInputStream表示文件输入流，FileOutStream表示文件输出流

-   装饰器设计模式

一般一个类值关注一个方面，实际使用时，经常会需要多个装饰类

Java中有很多装饰类，有两个基类：过滤器输入流FilterInputStream和过滤器输出流FilterOutStream，过滤器类只是增加功能，如：缓冲器类、8种基本类型和字符串对流进行读写的子类、对流进行压缩和解压缩的子类

-   Reader/Writer

能够方便的按字符处理文本数据的基类是Reader和Writer，有很多子类：读写文件、缓冲装饰、字符数组包装、字符串包装

-   随机读写文件

一个独立的可以随机读写文件的类RandomAccessFile，适用于大小已知的记录组成的文件

-   File

关于文件路径、文件元数据、文件目录、临时文件等，使用File类

-   NIO

介绍java.nio包

NIO代表一种不同的看待IO的方法，他有缓冲区和通道的概念。他们更接近操作系统地概念，某些操作的性能也更高

NIO还支持一些比较底层的功能，如内存映射文件、文件加锁、自定义文件系统、非阻塞IO、异步IO等

-   序列化和反序列化

简单来说，序列化就是将内存中的Java对象持久保存到一个流中，反序列化就是从流中恢复Java对象到内存。

在只用于网络远程调用的情况下，有很多流行的、跨语言的、精简且高效的对象序列化机制，如ProtoBuf、Thrift、MessagePack等，MessagePack是二进制形式的JSON，更快更小

-   章节安排
    -   二进制文件
    -   文本文件
    -   文件本身和目录操作
    -   一些具体类型的文件

----

##  二进制文件和字节流
-   InputStream/OutputStream：基类，抽象类
-   FileInputStream/FileOutputStream：输入源和输出目标是文件的流
-   ByteArrayInputStream/ByteArrayOutputStream：输入源和输出源是字节数组的流
-   DataInputStream/DataOutputStream：装饰类，按基本类型和字符串而非只是字节读写流
-   BufferedInputStream/BufferedOutputStream：装饰类，对输入输出流提供缓存功能

----

##  文本文件和字符流
-   Reader/Writer：字符流的基类，他们是抽象类
-   InputStreamReader/OutputStreamWriter：适配器类，将字节流转换为字符流
-   FileReader/FileWriter：输入源和输出源目标是文件的字符流
-   CharArrayReader/CharArrayWriter：输入源和输出目标是char数组的字符流
-   StringReader/StringWriter：输入源和输出目标是String的字符流
-   BufferedReader/BufferedWriter：装饰类，对输入/输出提供缓冲，以及按行读写功能
-   其他
    -   Scanner是一个单独的类，一个简单的文本扫描器，能够分析基本类型和字符串，需要一个分隔符将不同数据区分开来，默认是使用空白符
    -   标准流System.out，向屏幕上输出，是一个PrintStream对象。标准流一个重要特点是，可以重定向
-   文本操作：logic0814.s13.TextFileUtils

----

##  文件和目录操作

File类既可以表示文件，也可以表示目录。主要操作大概分为三类：文件元数据、文件操作、目录操作

-   文件元数据
    -   文件名和路径
    -   文件基本信息
    -   目录的基本信息
    -   安全和权限相关
-   文件操作
    -   创建
    -   删除
    -   重命名
-   目录操作
    -   创建
    -   遍历
    -   删除
-   目录操作：logic0814.s13.FileUtils

----
