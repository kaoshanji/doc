# 集群

集群目标：允许消费者和生产者在 Rabbit 节点崩溃的情况下继续运行，以及通过添加更多节点来线性扩展消息通信吞吐量。

##  集群内部

1.  集群节点分为两种：磁盘节点和内存节点，建议，磁盘节点有两个，作为备用，并不提供服务，内存节点提供服务

2.  配置元数据如队列、交换器、绑定和vhost等元数据会被各个节点共享，但是，队列数据是不会

3.  集群中必须有一个磁盘节点，内存节点加入或离开需要告知

4.  内存节点挂了再启动，在元数据同步之后就可以提供服务了，但是磁盘节点不能，貌似需要恢复?

5.  磁盘节点有两个，但是都是备用，一个挂了还有另外一个，并不影响集群功能，但是磁盘节点都挂了，创建配置元数据操作是不能进行。

6.  集群中的每个节点都可以接收消息，但是，只有指定的队列节点才能处理

7.  每个队列有属于自己的进程，但是交换器只是逻辑上存在，信道根据路由键同交换器列表进行比较，然后路由消息，信道才是真正的路由器！

8.  交换器只是一张查询表

9.  当消息已经发布到信道，但还未完成路由之前发生故障，有两种解决办法：AMQP事务和发送方确认模式

10. 内存节点把磁盘节点地址保存到磁盘

11. RabbitMQ 集群应该在本地局域网内创建，对延迟非常敏感