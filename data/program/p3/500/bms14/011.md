#   规模化


服务数量多了故障的概率也很大，可以通过引发故障，并为其构建系统。

1.  服务故障

-   超时
-   断路器
-   舱壁
-   隔离

2.  服务调用

-   功能降级
-   幂等

3.  扩展系统

-   强大的主机

有的服务需要计算、有的需要存储、有的需要网络

-   拆分负载

降低关键某些服务的负载，也不能承担该服务宕机，就需要分开部署

-   分散风险

把服务放在不同的主机上面，鸡蛋不要放在一个篮子里

-   负载均衡

让服务具有弹性，避免单点故障。

在一个负载均衡器后面，放置多台主机运行的微服务实例

-   基于 worker 的系统

-   重新设计

系统最初的架构和能够应对很大负载容量的架构师不同的，但是一开始是不会去预估很大负载

4.  扩展数据库

-   服务的可用性和数据的持久性

写入数据库挂了，虽然备份了数据，但是写入数据的服务还是不可用

-   扩展读取

缓存数据

只读副本

-   扩展写操作

有分片操作，但是添加实例很难

可以加大点机器比较快速

考虑：Cassandra、Mongo或者Riak这样的数据库

-   共享数据库基础设施

一个数据库服务器上面有多个数据库，当这个服务器挂了就都用不了了

-   CQRS

系统的一部分负责获取修改状态的请求命令并处理他，而另一部分则负责处理查询

5.  缓存

-   客户端、代理和服务器的缓存
-   HTTP缓存
-   为写使用缓存
-   为弹性使用缓存

6.  CAP定理

7.  动态服务注册

-   Zookeeper
-   Consul
-   Eureka

