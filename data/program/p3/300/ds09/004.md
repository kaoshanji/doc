#   分布式算法

##  时间和全局状态

时间是一个重要的问题。

全局物理时间得缺乏使得很难找到分布式程序在执行时的状态。

### 简介

介绍一些基本概念和算法，他们与分布式系统运行时的监控有关，与发生在分布式系统运行中的事件时序有关。

### 时钟、事件和进程状态

时钟：每个计算机有他们自己的物理时钟。

时钟偏移和时钟漂移：两个时钟的读数之间的瞬间不同称为时钟偏移。

通用协调时间(UTC)：是国际计时标准，他基于原子时间。

### 同步物理时钟

为了知道在分布式系统的进程中事件发生的具体时间，有必要用权威的外部时间源同步进程的时钟，这标为外部同步。

-   同步系统中的同步

考虑最简单的情况：在一个同步分布式系统中，两个进程之间的内部同步。

-   同步时钟的 Cristian 方法

Cristian 建议使用一个时间服务器，他连接到一个接收UTC信号的设备上，用于实现外部同步。在接收到请求后，服务器进程S根据他的时钟提供时间。

-   Berkeley 算法

在 Berkeley 算法中，选择一台协调者计算机作为主机，定期轮询其他要同步时钟的计算机(从属机)。

-   网络时间协议

网络时间协议(NTP)定义了时间服务的体系结构和在互联网上发布时间信息的协议。

### 逻辑时间和逻辑时钟

逻辑时钟：是一个单调增长的软件计算器，它的值与任何物理时钟无关。每个进程维护他自己的逻辑时钟，进程用他给事件加上所谓的 Lamport 时间戳。

全序逻辑时钟

向量时钟


### 全局状态

分布式无用单元收集：如果在分布式系统中不再对某个对象进行任何引用，那么该对象被认为是无用的。

分布式死锁检测：当一组进程中的每一个进程都在等待另一个进程给他发送消息，并且在这种"等待"关系图中存在循环时，就会发生分布式死锁。

分布式终止检测：检测一个分布式算法是否终止。

分布式调试：要非常仔细才能确定系统执行过程中发生了什么。

-   全局状态和一致割集

如果所有进程都有完全同步的时钟，那么我们可以在同一时间让每个进程记录下他的状态---结果就是系统实际的全局状态。从进程状态集中可以判断进程是否发生死锁等。

一致的全局状态是指对应于一致割集的状态。

-   全局状态调用、稳定性、安全性和活性

-   Chandy 和 Lamport 的 "快照"算法

Chandy 和 Lamport 描述了决定分布式系统全局状态的"快照"算法，该算法的目的是记录进程集的进程状态和通道状态集。

### 分布式调试

-   收集状态

所观察的进程最初用状态消息向监控器进程发送他们的初始状态，这以后也会不时发送状态消息。

-   观察一致的全局状态

使用由被观察进程保存的向量时间戳和在被观察进程发送给监控器的状态消息上附带信息，这样，监控器进程可以判断一个给定的全局状态是否一致。

-   判断可能的

为了判断可能的，监控器进程必须从初始状态开始，遍历可达状态的网格。

-   判断明确的

为了判断明确的，监控器进程再次从初始状态开始，每次一层的遍历可到达状态的网格。

-   在同步系统中判断可能的和明确的


##  协调和协定

在发生故障时，分布式系统中的进程如何协调他们的动作和对共享值达成协定。

### 简介

介绍一组算法，目标不同，但却都具有分布式系统的一个基本目的：供一组进程来协调他们的动作或对一个或多个值达成协定。

考虑故障以及在设计算法时如何处理故障。

### 分布式互斥

介绍实现一组进程互斥的算法，该算法可用于协调这些进程对共享资源的访问。

分布式进程常常需要协调他们的动作。如果一组进程共享一个或一组资源，那么访问这些资源时，常需要互斥来防止干扰并保证一致性。这就是在操作系统领域中常见的临界区问题。

在分布式系统中，也需要一个解决分布式互斥问题的解决方案：一个仅基于消息传递的解决方案。

-   互斥算法
-   中央服务器算法
-   基于环的算法
-   使用组播和逻辑时钟的算法
-   Maekawa 投票算法


### 选举

分布式系统中如何实现选取，即在前一个协调者出现故障后，一组进程如何能就新协调者达成一致。

选择一个唯一的进程来扮演特定角色的算法称为选举算法。

-   基于环的选举算法
-   霸道算法


### 组通信中的协调与协定

在组播中，问题是对消息发送顺序这样的事情如何达成协定。

-   基本组播：拥有一个可自由使用的基本组播原语是有用的，与IP组播不同，该原语保证，只要组播进程不崩溃，一个正确的进程最终会传递消息。
-   可靠组播：在可靠组播发送中，非常需要类似完整性和有效性的性质
-   有序组播
    -   FIFO排序
    -   因果排序
    -   全排序

### 共识和相关问题

共识和其他的问题是由如下问题归纳而来：一组进程如何对一些值达成协定，而不管这些值的值域是什么。

-   系统模型和问题定义

系统模型包括一组通过消息传递进行通信的进程。

拜占庭将军问题：3个或更多的将军协商是进攻还是撤退。一个将军发布命令，其他的将军决定是进程还是撤退。

交互一致性：目的是正确的进程最终就一个值向量达成一致，向量中的分量与一个进程的值对应。

共识问题与其他问题的关联：用解决另一个问题的方法来解决这个问题

-   同步系统中的共识问题

-   同步系统中的拜占庭将军问题

-   异步系统的不可能性

太复杂了。。。

----